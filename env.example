# =============================================================================
# CopperMind v1.0.0 - Environment Configuration
# =============================================================================
# Copy this file to .env and fill in your values:
#   cp env.example .env
# =============================================================================

# -----------------------------------------------------------------------------
# Database (Supabase PostgreSQL)
# -----------------------------------------------------------------------------
# Supabase connection string:
DATABASE_URL=postgresql://postgres:YOUR_PASSWORD@db.xxxxx.supabase.co:5432/postgres

# -----------------------------------------------------------------------------
# Pipeline Lock & Model Storage
# -----------------------------------------------------------------------------
PIPELINE_LOCK_FILE=/data/pipeline.lock
MODEL_DIR=/data/models

# -----------------------------------------------------------------------------
# Pipeline Trigger Authentication (Required for public deployment)
# -----------------------------------------------------------------------------
# Secret token for POST /api/pipeline/trigger
# Generate a random 32+ character string. Do not commit real values.
PIPELINE_TRIGGER_SECRET=


# -----------------------------------------------------------------------------
# News Sources
# -----------------------------------------------------------------------------
# NewsAPI key (optional - if empty, RSS fallback is used)
# Get your key at: https://newsapi.org/
NEWSAPI_KEY=

# Search query for copper-related news
NEWS_QUERY=copper OR copper price OR copper futures OR copper mining

# Language filter (FinBERT is optimized for English)
NEWS_LANGUAGE=en

# -----------------------------------------------------------------------------
# Price Data (yfinance)
# -----------------------------------------------------------------------------
# Comma-separated symbols: HG=F (Copper), DX-Y.NYB (DXY), CL=F (Oil), FXI (China ETF)
YFINANCE_SYMBOLS=HG=F,DX-Y.NYB,CL=F,FXI

# How many days of historical data to fetch
LOOKBACK_DAYS=365

# -----------------------------------------------------------------------------
# Fuzzy Deduplication (RSS noise reduction)
# -----------------------------------------------------------------------------
# Similarity threshold (0-100) for fuzzy title matching
FUZZY_DEDUP_THRESHOLD=85

# Time window (hours) for fuzzy dedup comparison
FUZZY_DEDUP_WINDOW_HOURS=48

# -----------------------------------------------------------------------------
# Sentiment Aggregation
# -----------------------------------------------------------------------------
# Exponential decay half-life for recency weighting (hours)
SENTIMENT_TAU_HOURS=12

# Fill value for days with no news
SENTIMENT_MISSING_FILL=0.0

# -----------------------------------------------------------------------------
# API Settings
# -----------------------------------------------------------------------------
# Cache TTL for analysis snapshots (minutes)
ANALYSIS_TTL_MINUTES=30

# Logging level: DEBUG, INFO, WARNING, ERROR
LOG_LEVEL=INFO

# -----------------------------------------------------------------------------
# Redis Queue (Worker)
# -----------------------------------------------------------------------------
# Redis URL for job queue (arq)
REDIS_URL=redis://localhost:6379/0

# -----------------------------------------------------------------------------
# Scheduler (DEPRECATED - Use GitHub Actions cron instead)
# -----------------------------------------------------------------------------
# These settings are no longer used in production.
# Pipeline scheduling is now external (GitHub Actions, Cloud Scheduler, etc.)
# The API only enqueues jobs; the Worker executes them.

# Daily pipeline run time (HH:MM format) - DEPRECATED
SCHEDULE_TIME=09:00

# Timezone for scheduler - DEPRECATED
TZ=Europe/Istanbul

# Enable/disable scheduler - DEPRECATED (default: false)
# Set to true only for local development without Redis
SCHEDULER_ENABLED=false

# -----------------------------------------------------------------------------
# OpenRouter AI Commentary (Optional)
# -----------------------------------------------------------------------------
# Get your free API key at: https://openrouter.ai/
OPENROUTER_API_KEY=

# Model to use for commentary (free tier options):
# - xiaomi/mimo-v2-flash:free (Recommended)
# - meta-llama/llama-3.2-3b-instruct:free
# - google/gemma-2-9b-it:free
OPENROUTER_MODEL=xiaomi/mimo-v2-flash:free

# -----------------------------------------------------------------------------
# LLM Sentiment Analysis (Replaces FinBERT)
# -----------------------------------------------------------------------------
# Model for news sentiment scoring (requires large context for batch processing)
# Uses OpenRouter API with same OPENROUTER_API_KEY
# Options: xiaomi/mimo-v2-flash:free, google/gemini-2.0-flash-exp:free
LLM_SENTIMENT_MODEL=xiaomi/mimo-v2-flash:free
